# CNP-building-blocks.db
R scripts for constructing a database on elemental composition (carbon, nitrogen and phosphorus) of food items

the project is based on four steps:

(1) original and incomplete data sets are combined for the comprehensive description concerning the content of macronutrients and constitutive molecules (e.g. proteins with amino acids) in more than 950 food items
- input: (i) **partial_db_original.xlsx** (it includes fatty acids and starch for 450 food items); (ii) **macronutrients details.xlsx** (with multiple sheets that include various details; e.g. carbon and nitrogen content in amino acids, sugar, protein and fat contents in more than 860 food items and phosphorus concentration in food)
- R scripts: (i) **add_data_original_db_function.R** (function that adds details on macronutrient and molecular composition of food items in a data set); (ii) **add_data_original_db.R** (script that calls the function add_data_original_db_function.R to integrate the incomplete dataset partial_db_original.xlsx (that only includes starch and fatty acids content for 450 food items) with more food items and concentration of various macromolecules (e.g. fats, sugars and proteins) and their constitutive molecules (e.g. fatty acids, carbohydrates and amino acids)
- output: **merged_db_original.xlsx** - such file includes the complete description of 955 food items in terms of macromolecules (i.e. total carbohydrates, protein and lipids) and their constitutive molecules (e.g. fatty acids: FA12_0 = C12:0, FA14_0 = C14:0, FA16_0 = C16:0, FA18_0 = C18:0, FA18_1 = C18:1, FA18_2 = C18:2, FA18_3 = C18:3, FA20_4 = C20:4, FA20_5 = C20:5, FA22_6 = C22:6) but still presents some issues (i.e. NA values and inconsistencies when comparing the total amounts of macromolecules vs. their constitutive building blocks)

(2) management of the data in merged_db_original.xlsx - first, NA values are classified as either zeros or proper missing values; second, for each food item a comparison between the total macronutrient content and the sum of its constitutive molecules is carried out
operations described in this step corresponds to the white boxes visualized in Figure 1 of Romeo et al. (to be submitted to Scientific Data). CNP-building-blocks.db: a comprehensive database about carbon, nitrogen and phosphorus content in simple and processed food.
- input: (i) **merged_db_original.xlsx** (for which evaluation of NA values and validation of building block composition vs. total macronutrient content must be performed for each food item); (ii) **macronutrients details.xlsx** (to import details on carbon and nitrogen concentration in the building block molecules of sugars, proteins and lipids - see the sheet "Element")
- R scripts: (i) **manage_NA_function.R** (function that classifies NA values as either zeros or non-zero values; i.e. in this latter case the total content of the macromolecule was evenly assigned to all its building blocks - this was the case of amino acids with respect to total amount of proteins); (ii) **check_totals_function.R** (function that compares the total amount of each macromolecule with the sum of the corresponding constitutive molecules - e.g. sum of amino acids vs. total protein concentration; if the difference exceeds by 1% in absolute value the total amount of macronutrient then such deviation is evenly redistributed among all partial components - either by adding or removing quantities of each building block molecule); (iii) **manage_NA---correct_total.R** (script that employs the two functions for dealing with NA values and inconsistencies between total macromolecules contents and their building block molecules; the script serves to obtain the first complete data output on food compositions and also produces a data quality file for technical validation)
- output: (i) **food_nutrient_composition_db.xlsx** (the file generated at this step is the first part of the database, which accounts for nutrient composition of food items); (ii) **data_quality.xlsx** (file storing details on the type of changes made/record of modifications - if any - to obtain concentration values reported in the file food_nutrient_composition_db.xlsx) - possible codes displayed by the file: SD - source data, meaning that the value was available in original sources; ND - not defined, the value was not reported in the original sources and set to zero during the execution of the script; MVR - missing value recalculated, which means that the value was declared as NA in the original dataset but the execution of the script quantified the concentration of the element by evenly distributing among all molecules (e.g. amino acids) the total amount of the corresponding macronutrient category (e.g. proteins); AVA+ - available value adjusted in positive, value available in the original sources that was proportionally increased to match the sum of simple molecules with the total amount of the corresponding macronutrient category; AVA- - available value adjusted in negative, value available in the original sources that was proportionally decreased to match the sum of simple molecules with the total amount of the corresponding macronutrient category

(3) conversion of nutrient data stored in food_nutrient_composition_db.xlsx into corresponding elemental contents (i.e. the output file includes details on carbon, nitrogen and phosphorus contents in food items)
- input: (i) **food_nutrient_composition_db.xlsx**; (ii) **macronutrient_details.xlsx**
- R script: **nutrients_to_CNP_db.R**
- output: **food_elemental_composition_db.xlsx**



(4)

Last, the database for the elemental composition of the 13 food categories ("Food\_category\_CNP\_db.xlsx") is calculated by the "Food categories average.R" script, which extracts the list of categories and the subset of food items to average from the file "Food data background.xlsx".
